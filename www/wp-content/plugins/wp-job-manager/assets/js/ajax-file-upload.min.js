jQuery(function(e){e(".wp-job-manager-file-upload").each(function(){e(this).fileupload({dataType:"json",dropZone:e(this),url:job_manager_ajax_file_upload.ajax_url.toString().replace("%%endpoint%%","upload_file"),maxNumberOfFiles:1,formData:{script:!0},add:function(a,t){var i=e(this),r=i.closest("form"),n=i.parent().find(".job-manager-uploaded-files"),o=[],l=e(this).data("file_types");if(l){var s=new RegExp("(.|/)("+l+")$","i");t.originalFiles[0].name.length&&!s.test(t.originalFiles[0].name)&&o.push(job_manager_ajax_file_upload.i18n_invalid_file_type+" "+l)}o.length>0?window.alert(o.join("\n")):(r.find(':input[type="submit"]').attr("disabled","disabled"),t.context=e('<progress value="" max="100"></progress>').appendTo(n),t.submit())},progress:function(e,a){var t=parseInt(a.loaded/a.total*100,10);a.context.val(t)},fail:function(a,t){var i=e(this).closest("form");t.errorThrown&&window.alert(t.errorThrown),t.context.remove(),i.find(':input[type="submit"]').removeAttr("disabled")},done:function(a,t){var i=e(this),r=i.closest("form"),n=i.parent().find(".job-manager-uploaded-files"),o=i.attr("multiple")?1:0,l=["jpg","gif","png","jpeg","jpe"];t.context.remove(),void 0===t.result.success||t.result.success||window.alert(t.result.data),e.each(t.result.files,function(a,t){if(t.error)window.alert(t.error);else{var r;e.inArray(t.extension,l)>=0?(r=e.parseHTML(job_manager_ajax_file_upload.js_field_html_img),e(r).find(".job-manager-uploaded-file-preview img").attr("src",t.url)):(r=e.parseHTML(job_manager_ajax_file_upload.js_field_html),e(r).find(".job-manager-uploaded-file-name code").text(t.name)),e(r).find(".input-text").val(t.url),e(r).find(".input-text").attr("name","current_"+i.attr("name")),o?n.append(r):n.html(r)}}),r.find(':input[type="submit"]').removeAttr("disabled")}})})});